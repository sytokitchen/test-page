<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FLBVCVDB7P"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-FLBVCVDB7P');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–°—ã—Ç–æ kitchen</title>
  <style>
    :root{
      --off-black:#1F2421;
      --dark-olive:#4B5311;
      --olive-metallic:#4A4F39;
      --dark-wood:#3E2F23;
      --accent:#D4AF37;
      --text:#f5f5f5;
      --header-h:72px;
    }
    html{scroll-behavior:smooth;}
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:Arial, sans-serif;
      background:var(--off-black);
      color:var(--text);
      overflow-x:hidden;
    }

    header{
      position:fixed; top:0; left:0; right:0; z-index:2000;
      height:var(--header-h); background:var(--dark-wood);
    }
    .header-inner{
      max-width:1100px; margin:0 auto; height:100%;
      padding:12px 22px; display:flex; align-items:center; justify-content:space-between; gap:16px;
    }
    .brand h1{margin:0; color:var(--accent); font-size:22px; letter-spacing:.5px; white-space:nowrap}
    nav{position:relative}
    .menu-toggle{
      display:none; align-items:center; justify-content:center;
      width:44px; height:44px; border-radius:10px; border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06); color:#fff; font-size:20px; line-height:1; cursor:pointer;
    }
    nav ul{list-style:none; display:flex; gap:12px; margin:0; padding:0; flex-wrap:wrap;}
    nav a{
      display:inline-block;
      padding:8px 12px;
      border-radius:10px;
      text-decoration:none;

      font-weight:600;
      color: var(--text);

      background: rgba(0,0,0,0.10);
      border: 1px solid var(--accent);
      box-shadow: 0 0 0 1px rgba(212,175,55,0.18) inset;
    }

    nav a:hover{
      background: rgba(212,175,55,0.12);
    }
    .btn{
      background:var(--dark-olive); color:#fff; padding:10px 16px;
      border-radius:10px; border:none; cursor:pointer; font-weight:bold;
    }
    .btn:hover{background:var(--olive-metallic);}

    main{margin:0; padding:0;}
    .hero, .section{scroll-margin-top:calc(var(--header-h) + 14px);}

    .hero{margin-top:var(--header-h);}
    .hero-figure{position:relative; width:100%; line-height:0; margin:0;}
    .hero-figure img{width:100%; height:auto; display:block;}

    .text-panel{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center; z-index:2;
      padding:0 20px; line-height:normal;
    }
    .text-box{
      max-width:860px; padding:16px 18px; border-radius:14px;
      background:rgba(0,0,0,0.38); backdrop-filter:saturate(120%) blur(2px);
      line-height:1.4;
    }
    .hero h2{margin:0 0 14px 0; color:#fff; font-size:clamp(30px,5vw,56px); font-weight:800; line-height:1.15;}
    .hero p{margin:0; color:#fff; font-size:clamp(16px,2.2vw,22px); line-height:1.55;}

    .section{
      padding:60px 20px;
      max-width:1000px;
      margin:0 auto;
    }
    .section-menu{
      max-width: 1400px;
    }
    .section h3{text-align:center; font-size:2em; color:var(--accent); margin-bottom:24px;}
    .grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:16px;}
    .card{
      background:rgba(0,0,0,0.25);
      border:1px solid rgba(255,255,255,0.1);
      border-radius:16px;
      padding:16px;
      box-shadow:0 4px 12px rgba(0,0,0,0.25);
    }
    .card h4{margin:0 0 8px; color:var(--accent);}
    .muted{color:#e7d6c8; opacity:.95;}
    footer{text-align:center; background:var(--dark-wood); color:var(--accent); padding:15px;}

    /* –ü—Ä–µ–¥–∑–∞–∫–∞–∑ - —Ñ–æ—Ä–º–∞ */
    #preorder{
      background:rgba(0,0,0,0.18);
      border-radius:18px;
      margin-top:20px;
      margin-bottom:40px;
    }
    .preorder-intro{
      text-align:left;
      font-size:18px;
      line-height:1.8;
      max-width:860px;
      margin:0 auto 24px;
    }
    .preorder-form{
      max-width:720px;
      margin:0 auto;
      display:grid;
      gap:16px;
    }
    .preorder-row{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .preorder-row label{
      font-size:15px;
      font-weight:600;
    }
    .preorder-row input,
    .preorder-row textarea{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(0,0,0,0.3);
      color:var(--text);
      font-size:15px;
      font-family:inherit;
    }
    .preorder-row input::placeholder,
    .preorder-row textarea::placeholder{
      color:rgba(245,245,245,0.6);
    }
    .preorder-row small{
      font-size:13px;
      opacity:0.8;
    }
    .preorder-actions{
      margin-top:6px;
      display:flex;
      justify-content:flex-start;
    }
    .set-options {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 4px;
      align-items: flex-start;
    }
    .set-options label {
      display: inline-flex;
      align-items: center;
      justify-content: flex-start;
      gap: 8px;
      white-space: nowrap;
      font-size: 14px;
      width: auto;
      text-align: left;
    }
    .set-options input[type="radio"] {
      cursor: pointer;
      accent-color: var(--accent);
      margin: 0;
    }

    /* –ê—É–¥–∏–æ-–∑–∞–ø–∏—Å—å */
    .audio-controls{
      display:flex;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }
    .audio-status{
      font-size:14px;
      opacity:0.9;
    }
    .btn-secondary{
      background:rgba(255,255,255,0.1);
      border:1px solid rgba(255,255,255,0.25);
    }
    .btn-secondary:hover{
      background:rgba(255,255,255,0.2);
    }
    .btn-secondary,
    .btn-secondary:visited,
    .btn-secondary:hover,
    .btn-secondary:active,
    .btn-secondary:focus{
      color: var(--text);
    }

    /* –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –¥–ª—è –±–ª–æ–∫–∞ "–î–æ—Å—Ç–∞–≤–∫–∞" */
    #delivery{
      border-top:1px solid rgba(255,255,255,0.06);
      padding-top:40px;
      margin-top:10px;
    }

    @media (max-width: 860px){
      .menu-toggle{display:flex}
      nav ul{
        position:absolute; top:calc(100% + 10px); right:0; left:auto;
        display:flex; flex-direction:column; gap:10px;
        background:rgba(33,33,33,.96); border:1px solid rgba(255,255,255,.12);
        border-radius:14px; padding:12px; width:min(86vw, 320px);
        transform:scale(.98); opacity:0; pointer-events:none;
        transition:opacity .18s ease, transform .18s ease;
      }
      nav.open ul{opacity:1; transform:scale(1); pointer-events:auto}
      nav a{width:100%; text-align:left}
    }

    @media (max-width: 540px){
      .text-box{max-width:92%; padding:14px 16px;}
    }

    /* ===== –ú–µ–Ω—é (–∫–∞—Ä—Ç–æ—á–∫–∏ –±–ª—é–¥) ===== */
    /* menu-grid —Ç–µ–ø–µ—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ) */
    #menu-grid{
      display:block;
    }

    .product-card{
      background:rgba(0,0,0,0.25);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:16px;
      overflow:hidden;
      box-shadow:0 4px 12px rgba(0,0,0,0.25);
      display:flex;
      flex-direction:column;
      max-width: 320px;
      width: 100%;
    }

    .product-img{
      width:100%;
      aspect-ratio: 4 / 3;
      background:rgba(255,255,255,0.06);
      object-fit:cover;
      display:block;
    }

    .product-body{
      padding:14px 14px 12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .product-title{
      margin:0;
      font-size:18px;
      font-weight:800;
      color:var(--accent);
      line-height:1.2;
    }

    .product-desc{
      margin:0;
      font-size:14px;
      line-height:1.5;
      color:#e7d6c8;
      opacity:.95;
    }

    .product-meta{
      margin-top:auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding-top:6px;
    }

    .product-price{
      font-weight:800;
      font-size:16px;
      color:#fff;
      white-space:nowrap;
    }

    .avail{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:13px;
      font-weight:700;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.06);
      white-space:nowrap;
    }

    .dot{
      width:10px;
      height:10px;
      border-radius:50%;
      box-shadow:0 0 0 3px rgba(255,255,255,0.06) inset;
    }

    .dot.green{ background:#2ecc71; }
    .dot.red{ background:#e74c3c; }

    .menu-note{
      max-width:860px;
      margin:0 auto 18px;
      text-align:left;
      font-size:16px;
      line-height:1.7;
      color:#e7d6c8;
      opacity:.95;
    }

    .menu-status{
      text-align:center;
      opacity:0.9;
      font-size:15px;
    }

    .menu-error{
      text-align:center;
      opacity:0.95;
      font-size:15px;
      color:#ffd1d1;
    }

    /* ===== –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ–Ω—é (–∞–∫–∫–æ—Ä–¥–µ–æ–Ω —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π) ===== */
    .menu-category{
      width:100%;
      display:block;
      margin: 18px 0 26px;
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 18px;
      background: rgba(0,0,0,0.18);
      overflow:hidden;
    }

    .category-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 16px 16px;
      cursor:pointer;
      user-select:none;
      background: rgba(255,255,255,0.04);
    }

    .category-header:hover{
      background: rgba(255,255,255,0.06);
    }

    .category-title{
      margin:0;
      font-size: 20px;
      font-weight: 900;
      color: var(--accent);
    }

    .category-meta{
      display:flex;
      align-items:center;
      gap:10px;
      opacity:.95;
      white-space:nowrap;
    }

    .chevron{
      display:inline-flex;
      width: 32px;
      height: 32px;
      align-items:center;
      justify-content:center;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
      transform: rotate(0deg);
      transition: transform .22s ease;
      font-size: 14px;
      line-height: 1;
    }

    .menu-category.collapsed .chevron{
      transform: rotate(-90deg);
    }

    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∏–º–∏—Ä—É–µ–º (height) */
    .category-panel{
      height: auto;
      overflow: hidden;
      transition: height .26s ease, opacity .20s ease;
      opacity: 1;
      will-change: height;
    }

    .menu-category.collapsed .category-panel{
      opacity: 0;
    }

    .category-products{
      display:grid;
      gap:16px;
      padding:16px;

      grid-template-columns: repeat(4, minmax(0, 1fr));
    }
    @media (max-width: 1100px){
      .category-products{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }
    @media (max-width: 780px){
      .category-products{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 480px){
      .category-products{ grid-template-columns: repeat(1, minmax(0, 1fr)); }
    }

    .site-warning{
      max-width: 860px;
      margin: 24px auto 0;
      padding: 14px 16px;
      font-size: 20px;
      line-height: 1.6;
      text-align: left;

      color: #e30707;
      background: rgba(200, 60, 60, 0.12);
      border: 1px solid rgba(200, 60, 60, 0.35);
      border-radius: 14px;
    }

    .about-accent{
      font-size: 22px;
      font-weight: 700;
      color: var(--accent);
      margin: 0 auto 18px;
      max-width: 860px;
      position: relative;
      padding-left: 14px;
    }

    .about-accent::before{
      content: none;
      position: absolute;
      left: 0;
      top: 4px;
      bottom: 4px;
      width: 4px;
      border-radius: 4px;
      background: var(--accent);
    }

    .about-subtitle{
      font-size: 20px;
      font-weight: 800;
      color: var(--accent);
      margin: 28px auto 12px;
      max-width: 860px;
    }

    .text-danger {
      color: #e30707;
      font-weight: 600;
      background: rgba(227, 7, 7, 0.08);
      padding: 2px 6px;
      border-radius: 6px;
    }
  </style>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<!-- Clockpicker (round clock) -->
<!-- <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/clockpicker/0.0.5/jquery-clockpicker.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/clockpicker/0.0.5/jquery-clockpicker.min.js"></script> -->


</head>

<body>
  <header>
    <div class="header-inner">
      <div class="brand"><h1>–°—ã–¢–û kitchen</h1></div>
      <nav aria-label="–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é">
        <button class="menu-toggle" aria-expanded="false" aria-label="–ú–µ–Ω—é">‚â°</button>
        <ul>
          <li><a href="#home">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="#about">–û –Ω–∞—Å</a></li>
          <li><a href="#menu">–ú–µ–Ω—é</a></li>
          <li><a href="#preorder">–ü—Ä–µ–¥–∑–∞–∫–∞–∑</a></li>
          <li><a href="#contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="home">
    <section class="hero" aria-label="–ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ">
      <figure class="hero-figure">
        <img src="photo_main1.jpg" alt="–ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ">
        <!-- <div class="text-panel">
          <div class="text-box">
            <h2>–ö—É—Ä—ã –≥—Ä–∏–ª—å –∏ —Å–≤–µ–∂–∞—è –¥–æ–º–∞—à–Ω—è—è –∫—É—Ö–Ω—è</h2>
            <p>–ú—ã –≥–æ—Ç–æ–≤–∏–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∏–∑ —Å–≤–µ–∂–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤: –∫—É—Ä—ã –≥—Ä–∏–ª—å, –º—è—Å–æ, –≥–∞—Ä–Ω–∏—Ä—ã –∏ —Å–∞–ª–∞—Ç—ã. –í—Å—ë –ø—Ä–æ—Å—Ç–æ –∏ –≤–∫—É—Å–Ω–æ ‚Äî –∫–∞–∫ –¥–æ–º–∞</p>
          </div> -->
        </div>
      </figure>
    </section>

    <section>
      <h3 class="site-warning">
        –ü–æ–ª–Ω–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∞–π—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.
        –°–µ–π—á–∞—Å –≤ –º–µ–Ω—é –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –±–ª—é–¥–∞ –¥–ª—è –ø—Ä–µ–¥–∑–∞–∫–∞–∑–∞.
        –ü–æ—Å–ª–µ –ù–æ–≤–æ–≥–æ –≥–æ–¥–∞ –Ω–∞ —Å–∞–π—Ç–µ –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤–µ—Å—å –Ω–∞—à –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç.
      </h3>
    </section>

    <section id="about" class="section">
      <h3>–û –Ω–∞—Å</h3>
      <p class="about-subtitle">
        –°—ã—Ç–Ω–∞—è –¥–æ–º–∞—à–Ω—è—è –∫—É—Ö–Ω—è –≤–Ω–µ –¥–æ–º–∞.
      </p>
      <p style="text-align:left; font-size:18px; line-height:1.8; max-width:860px; margin:18px auto 0;">
        <strong>–°—ã–¢–û kitchen</strong> –∫—É—Ö–Ω—è –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –≥–¥–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –≤–∫—É—Å, –∫–∞—á–µ—Å—Ç–≤–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. 
        –ú—ã –≥–æ—Ç–æ–≤–∏–º –∏–∑ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å—ã—Ä—å—è: –∫—É—Ä—ã –≥—Ä–∏–ª—å, –º—è—Å–Ω—ã–µ –±–ª—é–¥–∞, –≥–∞—Ä–Ω–∏—Ä—ã –∏ —Å–∞–ª–∞—Ç—ã. 
        –ü—Ä–æ—Å—Ç—ã–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –±–ª—é–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–Ω–∏–º–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ. –ü—Ä–æ—Å—Ç–æ. –ß–µ—Å—Ç–Ω–æ. –í–æ–≤—Ä–µ–º—è.
      </p>
      <h4 class="about-subtitle">
        –û –ø—Ä–æ–µ–∫—Ç–µ
      </h4>
      <p style="text-align:left; font-size:18px; line-height:1.8; max-width:860px; margin:18px auto 0;">
        <strong>–°—ã–¢–û kitchen</strong> - –¥–æ–º–∞—à–Ω—è—è –∫—É—Ö–Ω—è –¥–æ–º–∞—à–Ω–∏–π –ø—Ä–æ–¥—É–∫—Ç —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ. 
          –ú—ã –∑–∞–∫—É–ø–∞–µ–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –Ω–µ–±–æ–ª—å—à–∏–º–∏ –ø–∞—Ä—Ç–∏—è–º–∏ –∏ –≥–æ—Ç–æ–≤–∏–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ. 
          –ï–¥–∞ –≤—Å–µ–≥–¥–∞ —Å–≤–µ–∂–∞—è. –ñ–∏–≤–∞—è.
      </p>
      <p style="text-align:left; font-size:18px; line-height:1.8; max-width:860px; margin:18px auto 0;">
        –ù–∞—à–µ –º–µ–Ω—é –ø–æ–Ω—è—Ç–Ω–æ–µ: 
          –∫—É—Ä–∏—Ü–∞ –≥—Ä–∏–ª—å, —Å—ã—Ç–Ω—ã–µ –º—è—Å–Ω—ã–µ –±–ª—é–¥–∞, –ø—Ä–æ—Å—Ç—ã–µ –≥–∞—Ä–Ω–∏—Ä—ã –∏ —Å–≤–µ–∂–∏–µ —Å–∞–ª–∞—Ç—ã.
          –ë–µ–∑ –ª–∏—à–Ω–µ–≥–æ ‚Äî —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—á–µ—Ç—Å—è –µ—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.
          –ò, –∫–æ–Ω–µ—á–Ω–æ, —Ö–æ—Ä–æ—à–∏–π –∫–æ—Ñ–µ.
      </p>
      <p style="text-align:left; font-size:18px; line-height:1.8; max-width:860px; margin:18px auto 0;">
        <strong>–°—ã–¢–û kitchen</strong> - –∫–æ–≥–¥–∞ –Ω–µ –Ω—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–∂–¥—É ¬´–±—ã—Å—Ç—Ä–æ¬ª –∏ ¬´–≤–∫—É—Å–Ω–æ¬ª.
          –ï–¥–∞ –¥–ª—è –æ–±–µ–¥–∞, —É–∂–∏–Ω–∞ –∏ –¥–æ–º–∞.
          –î–ª—è –≤–∞—Å –∏ –≤–∞—à–µ–π —Å–µ–º—å–∏. –ë–µ–∑ –ª–∏—à–Ω–∏—Ö –¥–æ–±–∞–≤–æ–∫. –ú—ã –≥–æ—Ç–æ–≤–∏–º —Ç–æ, —á—Ç–æ —Å–∞–º–∏ –µ–¥–∏–º!
      </p>
    </section>

    <section id="menu" class="section section-menu">
      <h3>–ú–µ–Ω—é</h3>
      <div class="site-warning">
        –í –ø—Ä–µ–¥–Ω–æ–≤–æ–≥–æ–¥–Ω–∏–π –ø–µ—Ä–∏–æ–¥ –∑–∞–∫–∞–∑—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –æ—Ç 500 –≥
        (¬´–°–µ–ª—å–¥—å –ø–æ–¥ —à—É–±–æ–π¬ª ‚Äî –æ—Ç 1 –∫–≥).
        –ë–ª—é–¥–∞ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ, –ø–æ–¥ –∫–∞–∂–¥—ã–π –∑–∞–∫–∞–∑.
      </div>
      <div id="menu-status" class="menu-status">–ó–∞–≥—Ä—É–∂–∞–µ–º –º–µ–Ω—é‚Ä¶</div>
      <div id="menu-grid" class="menu-grid" aria-live="polite"></div>
    </section>

    <section id="preorder" class="section">
      <h3>–ü—Ä–µ–¥–∑–∞–∫–∞–∑ (—Å–∞–º–æ–≤—ã–≤–æ–∑)</h3>
      <p class="preorder-intro">
        –ú—ã —Ä–∞–¥—ã –ø—Ä–∏–Ω—è—Ç—å –≤–∞—à –∑–∞–∫–∞–∑!
        –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à–µ –∏–º—è, –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –∂–µ–ª–∞–µ–º—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è.
        –ü—Ä–æ—Å—Ç–æ –æ–ø–∏—à–∏—Ç–µ –≤–∞—à –∑–∞–∫–∞–∑ –≤ –ø–æ–ª–µ –∑–∞–∫–∞–∑–∞.
        –ï—Å–ª–∏ –≤–∞–º —É–¥–æ–±–Ω–µ–µ, –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.
        <span class="text-danger">–í –ø—Ä–µ–¥–Ω–æ–≤–æ–≥–æ–¥–Ω–∏–π –ø–µ—Ä–∏–æ–¥ –∑–∞–∫–∞–∑—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –æ—Ç 500 –≥
        (¬´–°–µ–ª—å–¥—å –ø–æ–¥ —à—É–±–æ–π¬ª ‚Äî –æ—Ç 1 –∫–≥).</span>
      </p>
      <form id="preorder-form" class="preorder-form">
        <div class="preorder-row">
          <label for="preorder-name">–§–ò–û</label>
          <input id="preorder-name" name="name" type="text" required />
        </div>

        <div class="preorder-row">
          <label for="preorder-phone">–¢–µ–ª–µ—Ñ–æ–Ω (–†–æ—Å—Å–∏—è)</label>
          <input
            id="preorder-phone"
            name="phone"
            type="tel"
            inputmode="tel"
            required
            placeholder="+7 (___) ___-__-__"
          />
        </div>

        <div class="preorder-row">
          <label for="preorder-date">–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞</label>
          <input
            id="preorder-date"
            name="date"
            type="text"
            required
            placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É"
          />
        </div>

        <div class="preorder-row">
          <label for="preorder-time">–í—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è</label>
          <input
            id="preorder-time"
            name="time"
            type="text"
            required
            placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è"
          />
          <small class="time-hint">–í—ã–¥–∞–µ–º –∑–∞–∫–∞–∑—ã —Å 11:00 –¥–æ 22:00.</small>
        </div>

        <div class="preorder-row" style="display:none">
          <label>–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≥–æ—Ç–æ–≤—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.</label>
          <div class="set-options">
            <label><input type="radio" name="set_choice" value="set1"> –°–µ—Ç 1</label>
            <label><input type="radio" name="set_choice" value="set2"> –°–µ—Ç 2</label>
            <label><input type="radio" name="set_choice" value="set3"> –°–µ—Ç 3</label>
            <label><input type="radio" name="set_choice" value="set4"> –°–µ—Ç 4</label>
            <label><input type="radio" name="set_choice" value="set5"> –°–µ—Ç 5</label>
            <label><input type="radio" name="set_choice" value="custom" checked> –°–≤–æ–π –≤—ã–±–æ—Ä</label>
          </div>
        </div>

        <div class="preorder-row">
          <label for="preorder-comment">–ó–∞–∫–∞–∑</label>
          <textarea
            id="preorder-comment"
            name="comment"
            rows="3"
            style="overflow:hidden; resize:none;"
            placeholder="–û–ø–∏—à–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–µ –±–ª—é–¥–∞, –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–ª–∏ –¥—Ä—É–≥–∏–µ –¥–µ—Ç–∞–ª–∏."
          ></textarea>
        </div>

        <div class="preorder-row">
          <label>–ì–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–ø–æ –∂–µ–ª–∞–Ω–∏—é)</label>
          <div class="audio-controls">
            <button type="button" class="btn btn-secondary" id="audio-record-btn">–ó–∞–ø–∏—Å–∞—Ç—å</button>
            <span class="audio-status" id="audio-status">–ó–∞–ø–∏—Å—å –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞</span>
          </div>
        </div>

        <div class="preorder-actions">
          <button type="submit" class="btn" id="preorder-submit-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø—Ä–µ–¥–∑–∞–∫–∞–∑</button>
        </div>
      </form>
    </section>

    <section id="contact" class="section" style="background:#1F2421;">
      <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
      <p style="text-align:center; font-size:18px;">üìç –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ö—É–¥—Ä–æ–≤–æ, —É–ª. –°—Ç—Ä–æ–∏—Ç–µ–ª–µ–π, 16</p>
      <p style="text-align:center; font-size:18px;">üìû +7 (950) 037-13-96</p>
      <p style="text-align:center; font-size:18px;">üïí –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 11:00 ‚Äî 22:00</p>
      <!-- <div>
        <iframe src="https://yandex.ru/sprav/widget/155493913207" width="100%" height="340" frameborder="0"></iframe>
      </div> -->
  <div style="border-radius:14px; overflow:hidden; border:1px solid rgba(255,255,255,0.12);">
    <iframe
      title="Yandex Map ‚Äî –°—ã–¢–û kitchen"
      src="https://yandex.com/map-widget/v1/?ll=30.522317%2C59.909144&z=22&pt=30.522317,59.909144,pm2rdm"
      width="100%"
      height="430"
      frameborder="0"
      allowfullscreen>
    </iframe>
  </div>
      <!-- <div style="margin-top:20px; border-radius:14px; overflow:hidden; border:1px solid rgba(255,255,255,0.12);">
        <iframe title="Yandex Map ‚Äî –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ö—É–¥—Ä–æ–≤–æ, —É–ª. –°—Ç—Ä–æ–∏—Ç–µ–ª–µ–π, 16" src="https://yandex.com/map-widget/v1/?mode=search&z=15&text=%D0%A1%D0%B0%D0%BD%D0%BA%D1%82-%D0%9F%D0%B5%D1%82%D0%B5%D1%80%D0%B1%D1%83%D1%80%D0%B3%2C%20%D0%9A%D1%83%D0%B4%D1%80%D0%BE%D0%B2%D0%BE%2C%20%D1%83%D0%BB%D0%B8%D1%86%D0%B0%20%D0%A1%D1%82%D1%80%D0%BE%D0%B8%D1%82%D0%B5%D0%BB%D0%B5%D0%B9%2C%2016" width="100%" height="430" frameborder="0" allowfullscreen></iframe>
      </div> -->
    </section>
  </main>

  <footer>¬© 2025 –°—ã–¢–û kitchen. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</footer>
  
  <script>
  // –ü–æ–¥–≥–æ–Ω—è–µ–º –≤—ã—Å–æ—Ç—É —Ö—ç–¥–µ—Ä–∞
  const hdr = document.querySelector('header');
  function syncHeaderHeight(){
    const h = hdr ? hdr.offsetHeight : 0;
    document.documentElement.style.setProperty('--header-h', h + 'px');
  }
  window.addEventListener('load', syncHeaderHeight);
  window.addEventListener('resize', syncHeaderHeight);

  // –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
  const nav = document.querySelector('header nav');
  const btn = document.querySelector('.menu-toggle');
  const links = nav.querySelectorAll('a');

  function closeMenu(){ nav.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }
  btn.addEventListener('click', e => {
    e.stopPropagation();
    const opened = nav.classList.toggle('open');
    btn.setAttribute('aria-expanded', opened ? 'true' : 'false');
  });
  document.addEventListener('click', e => { if(!nav.contains(e.target)) closeMenu(); });
  document.addEventListener('keydown', e => { if(e.key === 'Escape') closeMenu(); });
  links.forEach(link => link.addEventListener('click', closeMenu));

  // ===== –ú–∞—Å–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ +7 (XXX) XXX-XX-XX =====
  const phoneInput = document.getElementById('preorder-phone');
  if (phoneInput) {
    phoneInput.addEventListener('input', () => {
      let digits = phoneInput.value.replace(/\D/g, '');
      if (digits.startsWith('8')) digits = '7' + digits.slice(1);
      if (!digits.startsWith('7')) digits = '7' + digits;
      digits = digits.slice(0, 11);

      let result = '+7';
      if (digits.length > 1) {
        result += ' (' + digits.slice(1, 4);
        if (digits.length >= 4) result += ')';
        if (digits.length > 4) result += ' ' + digits.slice(4, 7);
        if (digits.length > 7) result += '-' + digits.slice(7, 9);
        if (digits.length > 9) result += '-' + digits.slice(9, 11);
      }
      phoneInput.value = result;
    });

    phoneInput.addEventListener('focus', () => {
      if (!phoneInput.value.trim()) {
        phoneInput.value = '+7 ';
      }
    });
  }

  // ===== –ê–≤—Ç–æ-resize textarea =====
  const commentArea = document.getElementById('preorder-comment');
  function autoResize(el) {
    el.style.height = 'auto';
    el.style.height = el.scrollHeight + 'px';
  }
  if (commentArea) {
    autoResize(commentArea);
    commentArea.addEventListener('input', () => autoResize(commentArea));
  }

  // ===== Placeholder –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±–æ—Ä–∞ —Å–µ—Ç–∞ =====
  const setRadios = document.querySelectorAll('input[name="set_choice"]');
  if (commentArea && setRadios.length) {
    const updateCommentPlaceholder = () => {
      const selected = Array.from(setRadios).find(r => r.checked);
      if (!selected) return;

      if (selected.value === 'custom') {
        commentArea.placeholder = '–û–ø–∏—à–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–µ –±–ª—é–¥–∞, –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–ª–∏ –¥—Ä—É–≥–∏–µ –¥–µ—Ç–∞–ª–∏.';
      } else {
        commentArea.placeholder = '–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–ø–∏—à–∏—Ç–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –Ω–∞–±–æ—Ä—É.';
      }
      autoResize(commentArea);
    };

    setRadios.forEach(r => r.addEventListener('change', updateCommentPlaceholder));
    updateCommentPlaceholder();
  }

  // ===== –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π date-picker (flatpickr) =====
  const dateInput = document.getElementById('preorder-date');
  if (dateInput && typeof flatpickr !== 'undefined') {
    flatpickr(dateInput, {
      dateFormat: 'd.m.Y',
      minDate: 'today'
    });
  }

 // ===== Time picker (flatpickr) =====
const timeInput = document.getElementById('preorder-time');
if (timeInput && typeof flatpickr !== 'undefined') {
  flatpickr(timeInput, {
    enableTime: true,
    noCalendar: true,
    dateFormat: 'H:i',
    time_24hr: true,
    minuteIncrement: 5,
    allowInput: true,
    minTime: '11:00',
    maxTime: '22:00',

    // disableMobile: true,

    onClose: (_, timeStr) => {
      if (!timeStr) return;
      if (timeStr < '11:00' || timeStr > '22:00') {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É 11:00 –∏ 22:00');
        timeInput.value = '';
        timeInput.focus();
      }
    }
  });
}

  // ===== –ê—É–¥–∏–æ-–∑–∞–ø–∏—Å—å =====
  const recordBtn = document.getElementById('audio-record-btn');
  const statusEl = document.getElementById('audio-status');
  let mediaRecorder = null;
  let audioChunks = [];
  let recordedBlob = null;
  let isRecording = false;

  async function startRecording() {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];
      mediaRecorder.ondataavailable = (e) => {
        if (e.data && e.data.size > 0) audioChunks.push(e.data);
      };
      mediaRecorder.onstop = () => {
        if (audioChunks.length > 0) {
          recordedBlob = new Blob(audioChunks, { type: 'audio/webm' });
          const seconds = Math.round(recordedBlob.size / 16000);
          statusEl.textContent = '–ó–∞–ø–∏—Å—å –≥–æ—Ç–æ–≤–∞ (–ø—Ä–∏–º–µ—Ä–Ω–æ ' + seconds + ' —Å–µ–∫.)';
        } else {
          statusEl.textContent = '–ó–∞–ø–∏—Å—å –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞';
          recordedBlob = null;
        }
      };
      mediaRecorder.start();
      isRecording = true;
      recordBtn.textContent = '–°—Ç–æ–ø';
      statusEl.textContent = '–ò–¥—ë—Ç –∑–∞–ø–∏—Å—å...';
    } catch (err) {
      console.error(err);
      alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞.');
    }
  }

  function stopRecording() {
    if (mediaRecorder) {
      mediaRecorder.stop();
      mediaRecorder.stream.getTracks().forEach(t => t.stop());
      mediaRecorder = null;
    }
    isRecording = false;
    recordBtn.textContent = '–ó–∞–ø–∏—Å–∞—Ç—å';
  }

  if (recordBtn) {
    recordBtn.addEventListener('click', () => {
      if (!isRecording) startRecording();
      else stopRecording();
    });
  }

  // ===== –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã –Ω–∞ Cloudflare Worker =====
  const preorderForm = document.getElementById('preorder-form');
  const submitBtn = document.getElementById('preorder-submit-btn');

  const WORKER_URL = 'https://syto-preorder.syto-kitchen.workers.dev'

  if (preorderForm) {
    preorderForm.addEventListener('submit', async function (e) {
      e.preventDefault();

      const formData = new FormData(preorderForm);
      if (recordedBlob) {
        formData.append('voice', recordedBlob, 'comment.webm');
      }

      submitBtn.disabled = true;
      submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';

      try {
        const response = await fetch(WORKER_URL, {
          method: 'POST',
          body: formData
        });

        if (response.ok) {
          alert('–°–ø–∞—Å–∏–±–æ! –ü—Ä–µ–¥–∑–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.');
          preorderForm.reset();
          recordedBlob = null;
          if (statusEl) statusEl.textContent = '–ó–∞–ø–∏—Å—å –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞';
          if (commentArea) autoResize(commentArea);
        } else {
          console.error('–û—Ç–≤–µ—Ç –≤–æ—Ä–∫–µ—Ä–∞:', await response.text());
          alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–∫–∞–∑–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.');
        }
      } catch (err) {
        console.error(err);
        alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø—Ä–µ–¥–∑–∞–∫–∞–∑';
      }
    });
  }

  // ===== –ü—É–±–ª–∏—á–Ω–æ–µ –º–µ–Ω—é (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ + –∞–∫–∫–æ—Ä–¥–µ–æ–Ω) =====
  const MENU_API_URL = 'https://menu.syto-kitchen.workers.dev/api/menu';
  const CATEGORIES_API_URL = 'https://menu.syto-kitchen.workers.dev/api/categories';

  const menuGrid = document.getElementById('menu-grid');
  const menuStatus = document.getElementById('menu-status');

  const FALLBACK_IMG = 'syto_cat.jpg';

  function escapeHtml(s){
    return String(s ?? '')
      .replaceAll('&','&amp;')
      .replaceAll('<','&lt;')
      .replaceAll('>','&gt;')
      .replaceAll('"','&quot;')
      .replaceAll("'",'&#039;');
  }

  function formatPrice(price, unit){
    if (price === null || price === undefined || price === '') return '';
    const p = String(price).trim();
    const u = String(unit ?? '').trim();
    return u ? `${p} ‚ÇΩ / ${u}` : `${p} ‚ÇΩ`;
  }

  function productCardHtml(p){
    const name = escapeHtml(p.name);
    const desc = escapeHtml(p.description || '');
    const price = formatPrice(p.price, p.price_unit);
    const img = escapeHtml(p.photo_url || FALLBACK_IMG);

    const available = !!p.is_available;
    const dotClass = available ? 'green' : 'red';
    const label = available ? '–í –Ω–∞–ª–∏—á–∏–∏' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏';

    return `
      <article class="product-card">
        <img class="product-img" src="${img}" alt="${name}"
             loading="lazy"
             onerror="this.onerror=null;this.src='${FALLBACK_IMG}'">
        <div class="product-body">
          <h4 class="product-title">${name}</h4>
          ${desc ? `<p class="product-desc">${desc}</p>` : `<p class="product-desc" style="opacity:.6">–û–ø–∏—Å–∞–Ω–∏–µ —Å–∫–æ—Ä–æ –¥–æ–±–∞–≤–∏–º.</p>`}
          <div class="product-meta">
            <span class="product-price">${price ? escapeHtml(price) : ''}</span>
            <span class="avail"><span class="dot ${dotClass}"></span>${label}</span>
          </div>
        </div>
      </article>
    `;
  }

  function getCollapsedStateKey(categoryId){
    return `menu_cat_collapsed_${categoryId}`;
  }

  function isCollapsed(categoryId){
    return localStorage.getItem(getCollapsedStateKey(categoryId)) === '1';
  }

  function setCollapsed(categoryId, value){
    localStorage.setItem(getCollapsedStateKey(categoryId), value ? '1' : '0');
  }

  // ---- Accordion animation helpers (height transition) ----
  function openPanel(section){
    const panel = section.querySelector('.category-panel');
    if (!panel) return;

    // start from current height (0) -> target height (scrollHeight)
    panel.style.height = panel.scrollHeight + 'px';

    // after transition end set to auto to allow dynamic content
    const onEnd = (e) => {
      if (e.propertyName !== 'height') return;
      panel.style.height = 'auto';
      panel.removeEventListener('transitionend', onEnd);
    };
    panel.addEventListener('transitionend', onEnd);
  }

  function closePanel(section){
    const panel = section.querySelector('.category-panel');
    if (!panel) return;

    // if auto -> set explicit px first, then animate to 0
    panel.style.height = panel.scrollHeight + 'px';
    // force reflow
    panel.offsetHeight;
    panel.style.height = '0px';
  }

  function applyInitialPanelState(section, collapsed){
    const panel = section.querySelector('.category-panel');
    const header = section.querySelector('.category-header');
    if (!panel || !header) return;

    if (collapsed) {
      section.classList.add('collapsed');
      header.setAttribute('aria-expanded', 'false');
      panel.style.height = '0px';
    } else {
      section.classList.remove('collapsed');
      header.setAttribute('aria-expanded', 'true');
      panel.style.height = 'auto';
    }
  }

  function toggleCategory(section){
    const header = section.querySelector('.category-header');
    const id = section.getAttribute('data-category-id');

    const willCollapse = !section.classList.contains('collapsed');

    if (willCollapse) {
      // collapsing
      section.classList.add('collapsed');
      header.setAttribute('aria-expanded', 'false');
      setCollapsed(id, true);
      closePanel(section);
    } else {
      // expanding
      section.classList.remove('collapsed');
      header.setAttribute('aria-expanded', 'true');
      setCollapsed(id, false);

      const panel = section.querySelector('.category-panel');
      if (panel) {
        // set from 0 -> scrollHeight
        panel.style.height = '0px';
        panel.offsetHeight;
      }
      openPanel(section);
    }
  }

  function renderGroupedMenu(categories, products){
    if (!menuGrid) return;

    const cats = Array.isArray(categories) ? categories.slice() : [];
    const prods = Array.isArray(products) ? products.slice() : [];

    cats.sort((a,b) => (Number(a.display_order ?? 0) - Number(b.display_order ?? 0)) || (Number(a.id) - Number(b.id)));
    prods.sort((a,b) => (Number(a.display_order ?? 0) - Number(b.display_order ?? 0)) || (Number(a.id) - Number(b.id)));

    const byCat = new Map();
    for (const p of prods) {
      const cid = p.category_id ?? null;
      if (!byCat.has(cid)) byCat.set(cid, []);
      byCat.get(cid).push(p);
    }

    const uncategorized = byCat.get(null) || byCat.get(undefined);
    const hasUncat = Array.isArray(uncategorized) && uncategorized.length > 0;

    const finalCats = cats.slice();
    if (hasUncat) {
      finalCats.push({ id: 'uncat', name: '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏', display_order: 999999999 });
    }

    const html = finalCats.map(c => {
      const cid = c.id;
      const title = escapeHtml(c.name || '–ö–∞—Ç–µ–≥–æ—Ä–∏—è');
      const list = (cid === 'uncat') ? uncategorized : (byCat.get(cid) || []);

      if (!list || list.length === 0) return '';

      const collapsed = isCollapsed(cid);

      return `
        <section class="menu-category ${collapsed ? 'collapsed' : ''}" data-category-id="${escapeHtml(cid)}">
          <div class="category-header" role="button" tabindex="0" aria-expanded="${collapsed ? 'false' : 'true'}">
            <h4 class="category-title">${title}</h4>
            <div class="category-meta">
              <span class="chevron">‚ñæ</span>
            </div>
          </div>

          <div class="category-panel">
            <div class="category-products">
              ${list.map(productCardHtml).join('')}
            </div>
          </div>
        </section>
      `;
    }).join('');

    menuGrid.innerHTML = html || '';

    // Attach handlers + apply initial states correctly
    menuGrid.querySelectorAll('.menu-category').forEach(section => {
      const header = section.querySelector('.category-header');
      const cid = section.getAttribute('data-category-id');
      const collapsed = isCollapsed(cid);

      applyInitialPanelState(section, collapsed);

      const onToggle = () => toggleCategory(section);

      header.addEventListener('click', onToggle);
      header.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          onToggle();
        }
      });
    });
  }

  async function loadMenu(){
    if (!menuGrid || !menuStatus) return;

    menuStatus.textContent = '–ó–∞–≥—Ä—É–∂–∞–µ–º –º–µ–Ω—é‚Ä¶';

    try{
      const [catsRes, menuRes] = await Promise.all([
        fetch(CATEGORIES_API_URL, { method: 'GET' }),
        fetch(MENU_API_URL, { method: 'GET' }),
      ]);

      if (!catsRes.ok) {
        const txt = await catsRes.text().catch(()=> '');
        throw new Error('Categories HTTP ' + catsRes.status + ' ' + txt);
      }

      if (!menuRes.ok) {
        const txt = await menuRes.text().catch(()=> '');
        throw new Error('Menu HTTP ' + menuRes.status + ' ' + txt);
      }

      const categories = await catsRes.json();
      const products = await menuRes.json();

      if (!Array.isArray(products) || products.length === 0){
        menuStatus.innerHTML = '<div class="menu-status">–ú–µ–Ω—é –ø–æ–∫–∞ –ø—É—Å—Ç–æ–µ.</div>';
        menuGrid.innerHTML = '';
        return;
      }

      menuStatus.textContent = '';
      renderGroupedMenu(categories, products);

      // Recalculate open panels on resize (grid height can change)
      window.addEventListener('resize', () => {
        document.querySelectorAll('.menu-category:not(.collapsed) .category-panel').forEach(panel => {
          // keep auto for open panels
          panel.style.height = 'auto';
        });
      });

    } catch (err){
      console.error(err);
      menuStatus.innerHTML = '<div class="menu-error">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–Ω—é. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.</div>';
      menuGrid.innerHTML = '';
    }
  }

  window.addEventListener('load', loadMenu);
  </script>

</body>
</html>
